FROM golang:1.25-alpine

WORKDIR /app

# Copiar archivos del broker
COPY Broker/ ./Broker/
COPY proto/ ./proto/
COPY go.mod .
COPY go.sum .

# ðŸ’¡ CORRECCIÃ“N: Copiar el archivo de preferencias de consumidores
# Asumimos que consumidores.csv estÃ¡ en el directorio raÃ­z de la construcciÃ³n de Docker.


# Descargar dependencias
RUN go mod tidy

# Compilar el broker
RUN cd Broker && go build -o /app/broker broker.go

# Exponer puerto
EXPOSE 50095

CMD ["./broker"]
